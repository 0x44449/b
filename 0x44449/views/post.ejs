<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title><%= base.title %> - <%= post.title %></title>
    <link rel="stylesheet" href="/stylesheets/common.css">

    <!-- highlightjs (code highlight) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="/javascripts/highlight.pack.js"></script>

    <script>
        hljs.initHighlightingOnLoad();
    </script>

    <style>
        .post_title {
            /*color: #673AB7;*/
            margin-bottom: 5px;
            font-size: 3em;
            font-family: 'Malgun Gothic';
        }

        .post_title_area {
            /*border-bottom: 1px solid #673AB7;*/
            border-bottom: 1px solid black;
        }

        .information_area {
            text-align: right;
            font-family: 'Malgun Gothic';
        }

        .date_area {
            display: inline-block;
        }

        .post_date {
            color: #9575CD;
            font-size: 12px;
        }

        .post_contents {
            font-family: 'Malgun Gothic';
        }

        .post_contents code {
            font-family: Consolas;
        }
    </style>
</head>
<body>
    <div class="left_panel">
        <%- include('left') %>
    </div>
    <div class="right_panel fl_clear">
        <div class="right_area">
            <div class="post_title_area">
                <h1 class="post_title"><%= post.title %></h1>
            </div>
            <div class="information_area">
                <div class="date_area">
                    <span class="post_date">c: <%= dateformat(post.created, 'yyyy.mm.dd') %></span>
                </div>
                <span class="post_date">/</span>
                <div class="date_area">
                    <span class="post_date">m: <%= dateformat(post.modified, 'yyyy.mm.dd') %></span>
                </div>
            </div>
            <% if (admin) { %>
            <div>
                <button id="btn_delete">delete</button>
                <button id="btn_edit">edit</button>
                <!-- jQuery -->
                <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
                <script>
                    $('#btn_delete').on('click', function(e) {
                        e.preventDefault();
                        var conf = confirm('Delete this post?');
                        if (conf === true) {
                            $.ajax({
                                type: 'POST',
                                url: '/api/post/delete',
                                data: JSON.stringify({ id: '<%= post.id %>' }),
                            contentType: "application/json; charset=utf-8",
                            xhrFields: {
                                withCredentials: true
                            }
                        })
                    .done(function(resp) {
                        location.href = '/';
                    })
                    .fail(function(xhr, status) {

                    });
                    }
                });
                $('#btn_edit').on('click', function(e) {
                    e.preventDefault();
                    location.href = '/edit/<%= post.id %>';
            });
                </script>
            </div>
            <% } %>
            <div class="post_contents">
                <%- contentsHtml %>
            </div>
        </div>
    </div>
</body>
</html>
